@model Cloud_computing_project_LAST.Models.Product
@inject Cloud_computing_project_LAST.Data.ApplicationDbContext DbContext

@{
    ViewData["Title"] = "ProductDetails";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var allProducts = DbContext.Product.ToList().FindAll(p => p.Id != Model.Id);
    var items = allProducts.Take(4).ToList();
}
<head>
    <style>
        .big-img img {
            width: 250px; /* Set the width */
            height: 237px; /* Set the height */
            object-fit: cover; /* Maintain aspect ratio and cover the container */
        }
        /* Styling for the stock labels */
        .stock-label {
            display: inline-flex;
            align-items: center;
            margin-right: 5px; /* Add space between icon and text */
        }

        /* Styling for the "In Stock" text and icon */
        .in-stock {
            color: #C7A17A; /* Change the color to green for in stock */
        }

        /* Styling for the "Out of Stock" text and icon */
        .out-of-stock {
            color: #a7a7a7; /* Light gray color for out of stock */
         }

        /* Styling for the stock text */
        .stock-text {
            margin-left: 5px; /* Add space between icon and text */
            font-size: 25px; /* Change the font size */
        }
        .stock-icon {
            font-size: 25px; /* Match the font size of the text */
            margin-right: 3px; /* Add space between icon and text */
        }

        .out-btn {
            font-size: 12px;
        text-transform: uppercase;
        color: #ffffff;
        letter-spacing: 2px;
        background: #343a40;
        padding: 9.5px 34px;
        text-decoration: none;
        border-radius: 5px;
        position: relative;
        z-index: 1;
        display: inline-block;
        border: 1px solid #343a40;
        font-weight: 500;
        }
                .stripe {
            position: relative; /* Changed to relative */
            width: 360px;
            height: 2px;
            background-color: #E2DFDD;
        }

        .stripe::after {
            content: "";
            position: absolute;
            left: 0;
            bottom: -10px;
            width: 100%;
            height: 2px;
            background-color: #E2DFDD;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body class=" dark-bg">
    <main>
        <!-- breadcrumb area start -->
        <section class="breadcrumb-area pt-140 pb-140 bg_img" data-background="/assets/images/bg/breadcrumb-bg1.jpeg" data-overlay="dark" data-opacity="5">
            <div class="shape shape__1"><img src="~/assets/images/shape/breadcrumb-shape-1.png" alt=""></div>
            <div class="shape shape__2"><img src="~/assets/images/shape/breadcrumb-shape-2.png" alt=""></div>
            <div class="container">
                <div class="row">
                    <div class="col-xl-12 text-center">
                        <h2 class="page-title">Product Details</h2>
                        <div class="cafena-breadcrumb breadcrumbs">
                            <ul class="list-unstyled d-flex align-items-center justify-content-center">
                                <li class="cafenabcrumb-item duxinbcrumb-end">
                                    <span>Product</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- breadcrumb area end -->
        <!-- product popup start -->
        <div class="product-popup product-popup-1">
            <div class="view-background">
                <div class="row">
                    <div class="col-md-4 align-self-center">
                       <img src="@Html.DisplayFor(model => model.ImageUrl)">
                    </div>
                    <div class="col-md-8">
                        <div class="viewcontent">
                            <div class="viewcontent__header">
                                <h2 style="color:white">@Html.DisplayFor(model => model.Name)</h2>
                                <a class="view_close product-p-close" href="javascript:void(0)"><i class="fal fa-times"></i></a>
                            </div>
                            <div class="viewcontent__price">
                                <label style="background-color:white"><span>$</span>8888</label>
                            </div>
                            <div class="viewcontent__stock">
                                <h4 style="background-color:white">Available :<span> In stock</span></h4>
                            </div>
                            <div class="viewcontent__details">
                                <p>Anlor sit amet, consectetur adipiscing elit. Fusce condimentum est lacus, non pretium risus lacinia vel. Fusce eget turpis orci.</p>
                            </div>
                            <div class="viewcontent__action">
                                <span>Qty</span>
                                <input type="number" placeholder="1">
                                <a class="site-btn" href="#">add to cart</a>
                            </div>
                            <div class="viewcontent__footer">
                                <ul class="list-unstyled">
                                    <li>Category:</li>
                                    <li>SKU:</li>
                                    <li>Brand:</li>
                                </ul>
                                <ul class="list-unstyled">
                                    <li>Watches</li>
                                    <li>2584-MK63</li>
                                    <li>Brenda</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- product popup end -->
        <!-- product details area start -->
        <div class="product-details__area pt-120 pb-110">
            <div class="container">
                <div class="row">
                    <div class="col-xl-6">
                        <div class="product-details__wrapper">
                            <div class="pd-img">
                                <div class="tab-content" id="pdContent">
                                    <div class="tab-pane fade show active" id="pd-1" role="tabpanel" aria-labelledby="pd-1-tab" style="background-color: white"> 
                                        <div class="big-img">
                                            <img src="@Html.DisplayFor(model => model.ImageUrl)" alt="" style="border: 6px solid black">
                                        </div>
                                    </div>
                                   
                                </div>
                            </div>
                           
                        </div>
                    </div>
                    <div class="col-xl-6">
                        <div class="product-details__content">
                            <div class="tr-wrapper d-flex align-items-center justify-content-between">
                                <h5 class="title" style="color: white; text-decoration: underline;">@Html.DisplayFor(model => model.Name)</h5>
                                
                            </div>
                            <hr class="white-line" style="width: 360px; height: 2px; background-color: white; border: none;">
                            <hr/>
                            <p style="color:lightgray; font-size: 20px;">
                                @Html.DisplayFor(model => model.Description)</p>
                             <hr/>
                            <hr />
                            @if (Model.InStock > 0)
                            {
                                <span class="stock-label in-stock">
                                    <i class="fal fa-check stock-icon" style=" color: #C7A17A"></i>
                                    <span class="stock-text">In Stock</span>
                                </span>

                            }
                            else
                            {
                                <span class="stock-label out-of-stock">
                                    <i class="fal fa-times stock-icon" style=" color: #a7a7a7"></i>
                                    <span class="stock-text">Out of Stock</span>
                                </span>
                            }
                            <hr/>
                            <div class="pp__price pp__price--2 d-flex">
                                <h6 class="label" style="color:white; font-size:20px;">Price - </h6>
                                <span class="price"> $@Model.Price</span>
                            </div>
                            <div class="product-quantity d-flex align-items-center">
                                <span>Quantity</span>
                                <input type="number" id="quantityInput" placeholder="0" min="0">
                                @if (Model.InStock > 0)
                                {
                                    <button class="site-btn" id="addToCartBtn">Add to Cart</button>
                                }
                                else
                                {
                                    <botton class="out-btn" id="addToCartBtnOut" disabled >Add to Cart</botton>
                                }
                            </div>
                            <a href="#0" class="wishlist"></a>
                            <div class="pd-social-wrapper">
                                <span class="share"></span>
                                <div class="social-links d-flex align-items-center">
                                    <a href="#0" style="background-color:#C7A17A"></a>
                                    <a href="#0" style="background-color:#C7A17A"></a>
                                    <a href="#0" style="background-color:#C7A17A"></a>
                                    <a href="#0" style="background-color:#C7A17A"></a>
                                    <a href="#0" style="background-color:#C7A17A"></a>
                                    <a href="#0" style="background-color:#C7A17A"></a>
                                    <a href="#0" style="background-color:#C7A17A"></a>
                                    <a href="#0" style="background-color:#C7A17A"></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            $(document).ready(function () {
                $('#addToCartBtnOut').on('click', function (e) {
                    e.preventDefault();
                    if ($(this).is(':disabled')) {
                        return false; // Prevent action if the button is disabled
                    }

                    // Perform your AJAX request or other actions
                    // Example AJAX code...
                });
            });

            $(document).ready(function () {
                $('#addToCartBtn').on('click', function (e) {
                    e.preventDefault(); // Prevent the default form submission

                    console.log('Add to Cart button clicked.');

                    // Get the product ID and quantity values
                    var productId = '@Model.Id'; // Replace with your actual product ID
                    var quantity = $('#quantityInput').val();

                    // Prepare data to be sent
                    var data = {
                        productId: productId,
                        quantity: quantity
                    };

                    // Send an AJAX request to your controller
                    $.ajax({
                        url: '/Carts/AddToCartShop', // Replace with your actual controller action route
                        type: 'POST',
                        data: data,
                        success: function (response) {
                            // Handle the success response here (if needed)
                           alert(response.message);
                        },
                        error: function (error) {
                            // Handle any errors that occur during the AJAX request
                            console.error('Error adding product to cart:', error);
                        }
                    });
                });
            });
        </script>
        <!-- product details area end -->
       
        <!-- releted products area start -->
        <div class="releted-product__area pt-100 pb-120">
            <div class="container">
                <div class="row">
                    <div class="col-xl-12">
                        <h2 class="rp-title mb-30" style="color:white">
                            Another Products
                        </h2>
                    </div>
                </div>
                <div class="row mt-none-30">
                   @foreach(var item in items)
                   {
                    <div class="col-xl-3 col-lg-6 col-md-6 mt-30">
                            <div class="pp__item pp__item--2 text-center pt-20 pb-20" style="background-color:white">
                            <div class="pp__action pp__action--2 d-flex align-items-center justify-content-center">
                                <div class="cart d-flex align-items-center justify-content-center">
                                    <a href="/CartItems/Cart"><i class="fal fa-shopping-basket"></i></a>
                                </div>
                                <div class="view d-flex align-items-center justify-content-center">
                                        <a href="#" class="product-link" data-product-id="@item.Id"><i class="fal fa-eye"></i></a>
                                </div>
                            </div>
                            <div class="pp__thumb pp__thumb--2 mt-35">
                                <img class="default" src="@item.ImageUrl" alt="" width="101" height="156">
                                    <img class="on-hover" src="@item.ImageUrl" alt="" width="101" height="156">
                             </div>
                            <div class="pp__content pp__content--2 mt-25">
                                <div class="pp__c-top d-flex align-items-center justify-content-center">
                                    <div class="pp__cat pp__cat--2">
                                        <a href="#0">-----------------</a>
                                    </div>
                                </div>
                                <h4 class="pp__title pp__title--2">
                                        <a asp-controller="Products" asp-action="ProductDetails" asp-route-id="@item.Id">@item.Name</a>
                                </h4>
                                <div class="pp__price pp__price--2 d-flex align-items-center justify-content-center">
                                    <h6 class="label">Price - </h6>
                                    <span class="price"> $@item.Price</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                   }
                   
                </div>
            </div>
        </div>
        <!-- releted products area end -->

    </main>
    script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            $('.product-link').on('click', function (e) {
                e.preventDefault(); // Prevent the default link behavior

                var productId = $(this).data('product-id');

                // Redirect to the ProductDetails action with the product ID as a parameter
                window.location.href = '/Products/ProductDetails/' + productId;
            });
        });
    </script>
</body>

